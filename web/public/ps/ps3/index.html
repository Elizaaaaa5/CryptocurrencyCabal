<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    PS3: CSI: Blockchain // Cryptocurrency Cabal
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.15-DEV" />

  <meta property="og:title" content="PS3: CSI: Blockchain" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://bitcoin-class.org/ps/ps3/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,400italic,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Special+Elite' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/rotunda.png">
  <link rel="shortcut icon" href="/rotunda.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Cryptocurrency Cabal" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  <link rel="stylesheet" href="http://bitcoin-class.org/css/cabal.css">

  
 
  
<script>
function showText(show,hide)
{
    document.getElementById(show).className = "show";
    document.getElementById(hide).className = "hide";
}
</script>
 

  

  
</head>

<body>
	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    


    <a href="http://bitcoin-class.org"><h1 class="brand-title">Crypto Currency Cabal</h1></a>
    <h2 class="brand-tagline">University of Virginia
    <br>cs4501 Fall 2015
    </h2>

    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href=""></a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/syllabus/">Syllabus</a>
          
          </li>
        
      </ul>
    </nav>

    <b><a href="/ps/">Assignments</a></b>
    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href="/ps/ps1/">PS1: Bitcoin Transactions</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/ps/ps2/">PS2: The Blockchain</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/registration/">Registration</a>
          
          </li>
        
      </ul>
    </nav>

    <b><A href="/classes/">Classes</a></b>
    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href="/classes/class13/">Class 13: Law and Policy</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/classes/class14/">Class 14: FBI Visit</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/classes/class15/">Class 15: Scripting Transactions</a>
          
          </li>
        
        <li><a href="/classes/"><em>More...</em></a></li>
      </ul>

    </nav>

    <a href="/0/">Spring 2015 Course</a>

    

  </div>
</div>

	
    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

    <section id="main">
            
            	<span class="post-date">
                	21 Oct 2015
            	</span>
            	
            

            
            	
            

			
			

			

			

            

<h1 id="draft-not-yet-posted:b29158b067a206a408f4a3d38e1dbe1a">DRAFT - Not yet posted!</h1>

<h1 id="problem-set-3-br-csi-blockchain:b29158b067a206a408f4a3d38e1dbe1a">Problem Set 3:<br> CSI: Blockchain</h1>

<p><div class="due">
Due: Sunday, 8 November at 8:29pm
   </div></p>

<h2 id="purpose:b29158b067a206a408f4a3d38e1dbe1a">Purpose</h2>

<p>The goal of this assignment is for everyone to gain experience analyzing
the blockchain and understanding of the anonymity of bitcoin (and
mechanisms that are used to increase or decrease it), and to hopefully
help the FBI catch some heinous criminals.</p>

<h3 id="collaboration-policy:b29158b067a206a408f4a3d38e1dbe1a">Collaboration Policy</h3>

<p>For this assignment, you may either work alone or with one other person
of your choice.  If you work with a partner, you should together submit
one assignment with both of your names on it that reflects your combined
efforts.  You may, and are encouraged to, discuss all of the problems
with anyone else you want (both on-line using the course web site or any
other means you choose, and in person).</p>

<h3 id="submission:b29158b067a206a408f4a3d38e1dbe1a">Submission</h3>

<p>Submit your answers as a single PDF file using <a href="https://www.dropbox.com/request/oar0AQeg4SJRNtdHbcSS">this
link</a>.  The name
of your file should be <code>&lt;your email ID&gt;-ps3.pdf</code> (if you worked alone)
or <code>&lt;partner1 email ID&gt;-&lt;partner2 email ID&gt;-ps3.pdf</code></p>

<p>Your submission should include clearly marked answers for all the
problems (highlighted in yellow).  None of the questions require
submitting a program, although you may find it helpful to write programs
to develop your answers.  If the code you write is less than a page, it
is best to just include it in the PDF writeup.  If it is longer, you may
submit separate code files (and mention them in the PDF submission).</p>

<h2 id="warm-up-manual-exploration:b29158b067a206a408f4a3d38e1dbe1a">Warm-Up: Manual Exploration</h2>

<p>You should have received by email a list of bitcoin addresses that were
given to us by the FBI.  These are addresses that were used to collect
ransom payments from victims of bitcoin ransomware attacks.  In the
scheme perpetrators encrypt a victim’s files and then demand that ransom
payment be made to a specific bitcoin address in return for the key to
decrypt the files.</p>

<p>One of the addresses are marked with your email ID.  The intent of this
is to ensure that the examination efforts are well distributed over the
provided addresses.  For the manual exploration question, you should
start with that address (but feel free to look at any of the addresses
in the file, and for the programmatic analysis questions, you&rsquo;ll want to
use all the addresses).</p>

<p>You can use any tool you want to answer these questions, but we suggest
using <a href="http://blockchain.info">blockchain.info</a>.  One useful thing you
can do there is look at the taint analysis to see which other addresses
a given addresses is interacting with (e.g., examine the <a href="https://blockchain.info/taint/14TCv5MKcyYCM3qij36x8xrKvKHHY1NXmq?reversed=true">reverse taint
analysis</a>
to see the addresses that are receiving bitcoin from the given address).</p>

<p><div class="problem">
<strong>Problem 1.</strong><br />
(a) What address are you investigating?<br />
(b) When was that address in use?<br />
&#40;c) How many victims appear to have paid into the address?<br />
(d) How much was collected from each victim (the most relevant value would be the value in US dollars at the time of the payment)?  Did all the victims pay the same amount, or did the requested amount vary by victim?<br />
(e) How did the ransomist (owner of this address) distribute the proceeds?  Is there a percentage split, or some other fee being paid by the ransomist to other addresses?<br />
(f) What else can you learn about the operation starting from your transaction?
   </div></p>

<p>Since our goal is to learn as much as we can about the overall
operation, you should post your answers to Problem 1 (for your address)
as a comment on this page.</p>

<h2 id="blockchain-apis:b29158b067a206a408f4a3d38e1dbe1a">Blockchain APIs</h2>

<p>One way to analyze the blockchain is to run a full bitcoin node, and
operate on your own local copy of the blockchain.  This requires
downloading and processing a large amount of data (approximately <a href="https://blockchain.info/charts/blocks-size">45
GB</a> today).  Instead, you
can use an external service that provides an API for interacting with
the blockchain.  Several such APIs exist including
<a href="https://blockchain.info/api">blockchain.info</a>, Bitpay&rsquo;s <a href="https://insight.is/">Insight
API</a>, and BlockCypher&rsquo;s <a href="http://dev.blockcypher.com/">Blockchain
API</a>.</p>

<p>For this assignment, you are welcome to use any services and open source
bitcoin libraries and openly-licensed code you want, but must follow the
license requirements of any code you use and credit this code in your
submission.</p>

<p>The starting examples we provide will use Python and the BlockCypher
<a href="http://dev.blockcypher.com/">Blockchain API</a>, and we provide some
directions to get started using this next (but feel free to use other
tools if you prefer).</p>

<h3 id="setting-up-blockcypher-api:b29158b067a206a408f4a3d38e1dbe1a">Setting up BlockCypher API</h3>

<p><strong>Install Python.</strong> Start by downloading and installing Python
  (<a href="https://www.python.org/downloads/release/python-350/">https://www.python.org/downloads/release/python-350/</a>.
  Note that Python V3 is incompatible with Python V2 (on MacOSX, the
  default <code>python</code> is Python 2.7.2; to use Python 3, use <code>python3</code>).
  Even if you are not familiar with Python, if you feel comfortable
  learning a new language on the fly you should be fine jumping right
  into this assignment. If you prefer a more structured intro to Python
  there are many tutorials available, including
  <a href="http://www.learnpython.org/">http://www.learnpython.org/</a>.</p>

<p><strong>Install the Blockcypher Python library.</strong> The <a href="https://github.com/blockcypher/blockcypher-python">BlockCypher Python
  library</a> provides a
  convenient way to use the APIs.  To install it, execute <code>pip install
  blockcypher</code> (in the command shell).</p>

<p>Here is some example code that uses the BlockCypher API to find all the
addresses which received bitcoin directly from a sending address:</p>

<pre><code class="language-Python">import blockcypher

def get_receivers(sending_address):
    receiving_addresses = set()
    r = blockcypher.get_address_details(sending_address)
    for tx in r['txrefs']: # loop through all transactions
        hash = tx['tx_hash']
        transaction = blockcypher.get_transaction_details(hash)
        # was this address an input
        sender = False
        for input in transaction['inputs']:
            if sending_address in input['addresses']:
                sender = True
                break
        if sender:
            for output in transaction['outputs']:
                for adr in output['addresses']:
                    receiving_addresses.add((adr, output['value']))

    return receiving_addresses

def satoshi_to_BTC(sval):
    return sval / 100000000

sender = '1Ez69SnzzmePmZX3WpEzMKTrcBF2gpNQ55'
print (&quot;Received from &quot; + sender + &quot;: &quot;)
for receiver in get_receivers(sender):
    print(&quot;   &quot; + receiver[0] + &quot; (&quot; + str(satoshi_to_BTC(receiver[1])) + &quot; BTC)&quot;)
</code></pre>

<p>To avoid API limits, you will want to <a href="https://accounts.blockcypher.com/">obtain an API
key</a>, and add an <code>api_key=APIKEY</code>
parameter to your requests.</p>

<p>You can also use direct web API requests:</p>

<pre><code class="language-Python">     r = requests.get('https://api.blockcypher.com/v1/btc/main/addrs/' + adr + '/full', params=API_KEY).json() 
</code></pre>

<p>To learn if an address is connected with a known wallet, you can use the</p>

<h2 id="follow-the-money:b29158b067a206a408f4a3d38e1dbe1a">Follow the Money</h2>

<p>Now it’s time to follow the money!</p>

<p>We want to figure out if there are any common addresses that eventually
receive coin from more than one of the starting addresses. This could
detect if the suspect addresses are running received coins through a
mixnet, but outputting to the same address eventually, which could mean
payments to the same vendor.</p>

<p>A good approach to this problem could be writing a program that
iteratively follows successive outputs from a series of seed addresses
down to a reasonable depth and then checks for overlap between sets.  We
want to find addresses that eventually receive bitcoin sent from more
than one of the ransom collection addresses, since these are likely to
be addresses involved in meaningful transactions.</p>

<p>We are also interested in finding out the relative importance of the
addresses found. You can determine this based on factors such as amount
of bitcoins they receive, number of seed addresses they are associated
with, or how many hops away the addresses are on average from associated
seed addresses.</p>

<p>We&rsquo;ll provide a few hints for things to do, but you should use these as
starting points and form your own ideas about ways to explore the blockchain.</p>

<h2 id="mixing-services:b29158b067a206a408f4a3d38e1dbe1a">Mixing Services</h2>

<p>The directions we provide use blockchain.info’s Python API (<a href="https://github.com/blockchain/api-v1-client-python">https://github.com/blockchain/api-v1-client-python</a>). We will be using its “blockexplorer” module.</p>

<p>Installing our Tools
Install Python.
Install Blockchain API library. Follow the directions to install Blockchain.info’s API (<a href="https://github.com/blockchain/api-v1-client-python">https://github.com/blockchain/api-v1-client-python</a>). Familiarize yourself with the blockexplorer module (<a href="https://github.com/blockchain/api-v1-client-python/blob/master/docs/blockexplorer.md">https://github.com/blockchain/api-v1-client-python/blob/master/docs/blockexplorer.md</a>). You will mainly be interacting with the “Address” object.</p>

<p><strong>suspects.txt</strong></p>

<p>Problem 4. Given the intel we have gathered from our analysis, what do you think some possible next steps could be to de-anonymize the addresses? What kind of additional outside data would be required to make blockchain based findings such as our own actionable intelligence for law enforcement?</p>

<p>Problem 4 (Bonus?). The following address (not included in suspects.txt) is suspected by the FBI to have been used directly by the attackers. See what interesting things you can find by following the money!</p>

<p>18dwCxqqmya2ckWjCgTYReYyRL6dZF6pzL</p>

<h1 id="anonymity-and-bitcoin:b29158b067a206a408f4a3d38e1dbe1a">Anonymity and Bitcoin</h1>

<p>Readings:</p>

<h3 id="submission-1:b29158b067a206a408f4a3d38e1dbe1a">Submission</h3>

<p>Follow the submission instructions at the beginning of this page by
8:29pm on Sunday, 8 November.</p>

	
			

			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/ps/ps2/">PS2: The Blockchain</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">
 
   var disqus_url = '';
   var disqus_shortname = 'davidevans'; 

    
   (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] ||  document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view
    the <a href="http://disqus.com/?ref_noscript">comments powered by
    Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

          
        
      <div class="footer">
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
	<hr class="thin" />

   <div class="funding">
University of Virginia<br>
cs4501: Introduction to Cryptocurrency<br>
Fall 2015
   </div>

	<p></p>
</div>

    </div>
  </div>
	

	

  
</body>
</html>
